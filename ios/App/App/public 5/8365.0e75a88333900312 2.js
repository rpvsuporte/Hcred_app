"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8365],{8365:(R,_,p)=>{p.r(_),p.d(_,{AnexosPageModule:()=>I});var x=p(2881),v=p(4341),u=p(9420),P=p(5207),m=p(467),o=p(1360);let M=(()=>{var i;class l{constructor(n){this.modalCtrl=n}ngOnInit(){}fecharModal(){this.modalCtrl.dismiss()}}return(i=l).\u0275fac=function(n){return new(n||i)(o.rXU(u.W3))},i.\u0275cmp=o.VBU({type:i,selectors:[["app-success-modal"]],standalone:!1,decls:9,vars:0,consts:[[1,"ion-padding"],[1,"modal-container"],["name","checkmark-done-circle-outline","color","success"],[1,"title"],[1,"message"],["expand","block",1,"btn-ok",3,"click"]],template:function(n,t){1&n&&(o.j41(0,"div",0)(1,"div",1),o.nrm(2,"ion-icon",2),o.j41(3,"h2",3),o.EFF(4,"Sucesso!"),o.k0s(),o.j41(5,"p",4),o.EFF(6,"Proposta cadastrada com sucesso!"),o.k0s(),o.j41(7,"ion-button",5),o.bIt("click",function(){return t.fecharModal()}),o.EFF(8," OK "),o.k0s()()())},dependencies:[u.Jm,u.iq],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;position:fixed;top:0;left:0;right:0;bottom:0;background:transparent!important}ion-modal[_ngcontent-%COMP%]::part(backdrop){background:transparent!important;--backdrop-opacity: 0}ion-modal[_ngcontent-%COMP%]{--backdrop-opacity: 0;--background: transparent}.modal-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:20px;border-radius:20px;background:#fff;z-index:10}ion-icon[_ngcontent-%COMP%]{font-size:100px;margin-bottom:16px;--ion-toolbar-background: transparent}.title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin-top:0;margin-bottom:8px;color:#435054}.message[_ngcontent-%COMP%]{color:#435054;margin-bottom:2rem;font-size:1.1rem}.btn-ok[_ngcontent-%COMP%]{--background: #004977;color:#fff;--border-radius: 12px;--box-shadow: 0 4px 10px #004977;font-weight:700;width:80px}"]}),l})();var C=p(7691),O=p(6480),b=p(4843),A=p(5032),y=p(3366),k=p(9260),F=p(8397);function j(i,l){if(1&i){const r=o.RV6();o.j41(0,"ion-button",20),o.bIt("click",function(){o.eBV(r);const t=o.XpG().index,e=o.XpG();return o.Njj(e.abrirCameraOuGaleria(t))}),o.EFF(1," Anexar Foto "),o.nrm(2,"ion-icon",21),o.k0s()}if(2&i){const r=o.XpG().index,n=o.XpG();o.AVh("input-erro",null==n.errosAnexos[r]?null:n.errosAnexos[r].arquivo)}}function S(i,l){if(1&i){const r=o.RV6();o.j41(0,"div",22)(1,"span"),o.EFF(2),o.k0s(),o.j41(3,"ion-icon",23),o.bIt("click",function(){o.eBV(r);const t=o.XpG().index,e=o.XpG();return o.Njj(e.removerAnexo(t))}),o.k0s()()}if(2&i){const r=o.XpG().$implicit;o.R7$(2),o.JRh(r.nomeArquivo)}}function T(i,l){if(1&i&&(o.j41(0,"ion-select-option",24),o.EFF(1),o.k0s()),2&i){const r=l.$implicit;o.Y8G("value",r),o.R7$(),o.JRh(r)}}function q(i,l){if(1&i){const r=o.RV6();o.j41(0,"div",14)(1,"ion-item")(2,"input",15,0),o.bIt("change",function(t){const e=o.eBV(r).index,c=o.XpG();return o.Njj(c.selecionarArquivo(t,e))}),o.k0s(),o.DNE(4,j,3,2,"ion-button",16)(5,S,4,1,"div",17),o.j41(6,"ion-select",18),o.mxI("ngModelChange",function(t){const e=o.eBV(r).$implicit;return o.DH7(e.tipo,t)||(e.tipo=t),o.Njj(t)}),o.DNE(7,T,2,2,"ion-select-option",19),o.k0s()()()}if(2&i){const r=l.$implicit,n=l.index,t=o.XpG();o.R7$(4),o.Y8G("ngIf",!r.nomeArquivo),o.R7$(),o.Y8G("ngIf",r.nomeArquivo),o.R7$(),o.AVh("input-erro",null==t.errosAnexos[n]?null:t.errosAnexos[n].tipo),o.R50("ngModel",r.tipo),o.R7$(),o.Y8G("ngForOf",t.tiposAnexo)}}const E=[{path:"",component:(()=>{var i;class l{constructor(n,t,e,c,s,a){this.navCtrl=n,this.apiService=t,this.navigationService=e,this.modalController=c,this.loadingController=s,this.toastService=a,this.anexos=Array(4).fill({arquivo:null,tipo:""}),this.errosAnexos=Array(4).fill({arquivo:!1,tipo:!1}),this.contratoOnline="",this.erroContratoOnline=!1,this.tiposAnexo=["Link enviado para o cliente.","Altera\xe7\xe3o cadastral - Telefone.","An\xe1lise de Risco.","Capta\xe7\xe3o Externa (Cliente Novo).","CNH","Comprovante de Conta Banc\xe1ria.","Comprovante de Estorno.","Comprovante M\xe1quina.","Comprovante Parentesco (Conta Terceiro).","Contato realizado com o Banco Emissor.","Contrato assinado.","CPF","Dados de Pagamento Conferidos.","Entrar em contato com o cliente novamente.","Enviar Contrato Online.","Espelho","Extratos banc\xe1rios 3 \xfaltimos meses.","Foto cart\xe3o frente.","Foto cart\xe3o verso.","Fun\xe7\xe3o 15 realizada.","Link Preenchido.","Print App Cart\xe3o.","RG","Selfie segurando cart\xe3o.","Solicito Cancelamento."],this.loading=null}ngOnInit(){}validarAnexos(){let n=!0;this.errosAnexos=this.anexos.map(()=>({arquivo:!1,tipo:!1}));for(let t=0;t<this.anexos.length;t++){const e=this.anexos[t],c=!!e.arquivo,s=!!e.tipo&&""!==e.tipo.trim();(c&&!s||!c&&s)&&(n=!1,this.errosAnexos[t]={arquivo:!c,tipo:!s},this.toastService.warning(`Anexo ${t+1}: preencha arquivo e tipo corretamente.`))}return n}selecionarArquivo(n,t){const e=n.target.files[0];this.anexos[t].arquivo=e,this.anexos[t].nomeArquivo=e?e.name:void 0}abrirCameraOuGaleria(n){var t=this;return(0,m.A)(function*(){var e;if(null!==(e=window.Capacitor)&&void 0!==e&&e.isNativePlatform())try{const c=yield C.i7.getPhoto({quality:80,allowEditing:!1,resultType:C.LK.DataUrl,source:C.ru.Prompt}),s=t.base64ToFile(c.dataUrl,`anexo-${n+1}.jpg`);t.anexos[n].arquivo=s,t.anexos[n].nomeArquivo=s.name,t.errosAnexos[n].arquivo=!1}catch(c){console.warn("Captura cancelada ou erro:",c)}else{const s=yield(yield fetch("https://picsum.photos/400")).blob(),a=new File([s],`simulado-${n+1}.jpg`,{type:s.type});t.anexos[n].arquivo=a,t.anexos[n].nomeArquivo=a.name,t.errosAnexos[n].arquivo=!1}})()}limparValor(n){return(null==n?void 0:n.replace(/R\$\s*/g,"").replace(/\s+/g,""))||""}removerAnexo(n){this.anexos[n]={arquivo:null,tipo:""},this.errosAnexos[n]={arquivo:!1,tipo:!1}}base64ToFile(n,t){const e=n.split(","),c=e[0].match(/:(.*?);/)[1],s=atob(e[1]);let a=s.length;const f=new Uint8Array(a);for(;a--;)f[a]=s.charCodeAt(a);return new File([f],t,{type:c})}cadastrarProposta(){var n=this;return(0,m.A)(function*(){const t=n.validarAnexos();if(n.erroContratoOnline=""===n.contratoOnline,!t||n.erroContratoOnline)return void(n.erroContratoOnline&&n.toastService.warning("Informe o contrato online."));yield n.showLoading("Cadastrando proposta...");const e=JSON.parse(localStorage.getItem("dados")||"{}"),s=(n.anexos.filter(d=>d.arquivo&&d.tipo).map(d=>({nomeArquivo:d.arquivo.name,tipo:d.tipo})),{});(e.boletos||[]).forEach((d,g)=>{s[`codigoBoleto${g+1}`]=d});const a={terceiroConta:e.terceiroConta||0};"banco"===e.tipoRecebimento&&Object.assign(a,{banco:e.banco,ContaAgencia:e.agencia,ContaCorrente:e.conta,ContaDigito:e.digito,tipoConta:e.tipoConta}),"pix"===e.tipoRecebimento&&Object.assign(a,{tipoChave:e.tipoChave,chavePix:e.chave}),1===e.terceiroConta&&("pf"===e.tipoTerceiro&&(Object.assign(a,{nomeTerceiro:e.nomeTerceiro,cpfTerceiro:e.cpfTerceiro,parentesco:e.parentescoTerceiro}),"outros"===a.parentesco&&(a.parentescoOutros=e.outrosParentesco)),"pj"===e.tipoTerceiro&&Object.assign(a,{nomeTerceiro:e.razaoSocialTerceiro,cpfTerceiro:e.cnpjTerceiro,parentesco:e.vinculoTerceiro}));const f={auth_hash:O.k,etapa1:{idProposta:0,tipo:e.tipo,tipoDescricao:e.tabela,tipoOperacaoCC:e.tipoOperacao,valorFinanciado:n.limparValor(e.valor),codigoBoleto:s,tipoPixFacil:e.tipoPixFacil},etapa2:{quantPrestacoes:parseInt(e.prazo||"0",10),valorTotal:n.limparValor(e.valorTotal)||n.limparValor(e.valor),valorPacela:n.limparValor(e.valorParcela)||""},etapa3:{cpf:e.cpf,nome:e.nomeCompleto,rg:e.rg,telefone:e.whatsapp,celular:e.celular,email:e.email},etapa4:{cepEndereco:e.cep,endereco:e.rua},etapa5:a,etapa6:{contratoOnline:n.contratoOnline},dadosUser:{idUser:localStorage.getItem("idLogado")}};var d;n.apiService.cadProposta(f).subscribe({next:(d=(0,m.A)(function*(g){if("erro"===g.estatus)n.toastService.error(g.mensagem);else{const h=g.idProposta||0;h?n.enviarAnexosAoServidor(h):(yield n.hideLoading(),n.toastService.warning("Proposta cadastrada, mas sem ID retornado."))}}),function(h){return d.apply(this,arguments)}),error:function(){var d=(0,m.A)(function*(){yield n.hideLoading(),n.toastService.error("Erro na conex\xe3o.")});return function(){return d.apply(this,arguments)}}()})})()}enviarAnexosAoServidor(n){var t=this;return(0,m.A)(function*(){const e=localStorage.getItem("idLogado")||"",c=localStorage.getItem("nomeLogado")||"",s=t.anexos.filter(a=>a.arquivo&&a.tipo&&""!==a.tipo.trim());try{const a=s.map(function(){var f=(0,m.A)(function*(d){const g=new FormData;return g.append("arquivo",d.arquivo),g.append("tipoAnexo",d.tipo),g.append("idProposta",n.toString()),g.append("idUser",e),g.append("nomeLogado",c),g.append("auth_hash",O.k),yield(0,b._)(t.apiService.S3Upload(g))});return function(d){return f.apply(this,arguments)}}());yield Promise.all(a),yield t.hideLoading(),t.mostrarModalSucesso()}catch{yield t.hideLoading(),t.toastService.error("Erro ao enviar anexos.")}})()}voltar(){const n=localStorage.getItem("dados"),t=n?JSON.parse(n).tipo:"";this.navigation("Cart\xe3o de Cr\xe9dito - Boleto"===t?"simulador/endereco":"Cr\xe9dito Consignado"===t?"simulador/cadastro":"simulador/banco")}navigation(n){this.navigationService.navigate(n)}showLoading(){var n=this;return(0,m.A)(function*(t="Processando..."){n.loading=yield n.loadingController.create({spinner:"dots",message:t,cssClass:"custom-loading",backdropDismiss:!1}),yield n.loading.present()}).apply(this,arguments)}hideLoading(){var n=this;return(0,m.A)(function*(){n.loading&&(yield n.loading.dismiss(),n.loading=null)})()}mostrarModalSucesso(){var n=this;return(0,m.A)(function*(){const t=yield n.modalController.create({component:M,cssClass:"success-modal-style",backdropDismiss:!1});yield t.present(),yield t.onDidDismiss(),n.navigation("index")})()}}return(i=l).\u0275fac=function(n){return new(n||i)(o.rXU(A.q9),o.rXU(y.G),o.rXU(k.o),o.rXU(u.W3),o.rXU(u.Xi),o.rXU(F.f))},i.\u0275cmp=o.VBU({type:i,selectors:[["app-anexos"]],standalone:!1,decls:21,vars:5,consts:[["fileInput",""],[1,"pageAnexo",3,"fullscreen"],[1,"topo-anexo"],["name","chevron-back-outline",1,"icone-voltar",3,"click"],["src","../../assets/img/logoHcred-mobile.png","alt","",1,"logo-anexo"],[1,"form-anexo"],["class","grupo-anexo",4,"ngFor","ngForOf"],[1,"contratoOnline"],["label","Envio de Contrato Online?","labelPlacement","floating","fill","outline",3,"ngModelChange","ngModel"],["value","Sim"],["value","N\xe3o"],[1,"buttons-container"],[2,"--background","#004977",3,"click"],[2,"--background","#F89B24",3,"click"],[1,"grupo-anexo"],["type","file","accept","image/*",2,"display","none",3,"change"],["expand","block",3,"input-erro","click",4,"ngIf"],["class","arquivo-selecionado",4,"ngIf"],["label","Tipo do Anexo","labelPlacement","floating","fill","outline",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["expand","block",3,"click"],["name","camera-outline"],[1,"arquivo-selecionado"],["name","trash-outline",3,"click"],[3,"value"]],template:function(n,t){1&n&&(o.j41(0,"ion-content",1)(1,"div",2)(2,"ion-icon",3),o.bIt("click",function(){return t.voltar()}),o.k0s(),o.j41(3,"h1"),o.EFF(4,"Anexos"),o.k0s(),o.nrm(5,"img",4),o.k0s(),o.j41(6,"h2"),o.EFF(7,"Anexos"),o.k0s(),o.j41(8,"ion-list",5),o.DNE(9,q,8,6,"div",6),o.j41(10,"div",7)(11,"ion-select",8),o.mxI("ngModelChange",function(c){return o.DH7(t.contratoOnline,c)||(t.contratoOnline=c),c}),o.j41(12,"ion-select-option",9),o.EFF(13,"Sim"),o.k0s(),o.j41(14,"ion-select-option",10),o.EFF(15,"N\xe3o"),o.k0s()()()(),o.j41(16,"div",11)(17,"ion-button",12),o.bIt("click",function(){return t.voltar()}),o.EFF(18,"Voltar"),o.k0s(),o.j41(19,"ion-button",13),o.bIt("click",function(){return t.cadastrarProposta()}),o.EFF(20,"Cadastrar Proposta"),o.k0s()()()),2&n&&(o.Y8G("fullscreen",!0),o.R7$(9),o.Y8G("ngForOf",t.anexos),o.R7$(2),o.AVh("input-erro",t.erroContratoOnline),o.R50("ngModel",t.contratoOnline))},dependencies:[x.Sq,x.bT,v.BC,v.vS,u.Jm,u.W9,u.iq,u.uz,u.nf,u.Nm,u.Ip,u.Je],styles:[".pageAnexo[_ngcontent-%COMP%]{--background: #efeef4}.topo-anexo[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;position:relative;padding:env(safe-area-inset-top) 20px 0 20px;background:#004977 url(pattern-hcred-bg.8b86045725d03264.png) no-repeat center center/cover;height:70px;color:#fff}.topo-anexo[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%);margin:0;font-size:1.2em}.icone-voltar[_ngcontent-%COMP%]{font-size:1.5em}.logo-anexo[_ngcontent-%COMP%]{height:50px;width:50px}.pageAnexo[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:20px 0 20px 15px;color:#004977}.form-anexo[_ngcontent-%COMP%]{display:flex;gap:20px;flex-direction:column;background:transparent}.form-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent;--border-color: transparent}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{display:flex;width:45%;--background: transparent;font-size:.9em;--box-shadow: none;border:1px solid #004977;padding:15px;color:#004977;margin-top:10px;border-radius:10px}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:10px}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--color: #004977;margin-left:8px;margin-top:10px;max-width:45%;--border-radius: 10px;--border-color: #004977;--ion-color-primary: #004977;--placeholder-color: #004977;--placeholder-opacity: 1;--highlight-color-focused: #004977}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(label){color:#004977}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(text){color:#004977}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(icon){color:#004977;opacity:1}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-button.input-erro[_ngcontent-%COMP%]{color:red;border:1px solid red}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select.input-erro[_ngcontent-%COMP%]{--color: #f44336;--border-color: #f44336;--highlight-color-focused: #f44336;--highlight-color-invalid: #f44336;--ion-color-primary: #f44336;--placeholder-color: #f44336;--placeholder-opacity: 1}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select.input-erro[_ngcontent-%COMP%]::part(label){color:#f44336}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select.input-erro[_ngcontent-%COMP%]::part(text){color:#f44336}.grupo-anexo[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select.input-erro[_ngcontent-%COMP%]::part(icon){color:#f44336;opacity:1}.arquivo-selecionado[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:transparent;border:1px solid #004977;padding:15px;border-radius:10px;margin-top:10px;width:45%}.arquivo-selecionado[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex-grow:1;color:#004977;font-style:italic;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:10px}.arquivo-selecionado[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2em;color:red;cursor:pointer}.contratoOnline[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:95%;margin:0 auto}.contratoOnline[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--color: #004977;margin-left:8px;margin-top:10px;--border-radius: 10px;--border-color: #004977;--ion-color-primary: #004977;--placeholder-color: #004977;--placeholder-opacity: 1;--highlight-color-focused: #004977}.contratoOnline[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(label){color:#004977}.contratoOnline[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(text){color:#004977}.contratoOnline[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(icon){color:#004977;opacity:1}.contratoOnline[_ngcontent-%COMP%]   ion-select.input-erro[_ngcontent-%COMP%]{--color: #f44336;--border-color: #f44336;--highlight-color-focused: #f44336;--highlight-color-invalid: #f44336;--ion-color-primary: #f44336;--placeholder-color: #f44336;--placeholder-opacity: 1}.contratoOnline[_ngcontent-%COMP%]   ion-select.input-erro[_ngcontent-%COMP%]::part(label){color:#f44336}.contratoOnline[_ngcontent-%COMP%]   ion-select.input-erro[_ngcontent-%COMP%]::part(text){color:#f44336}.contratoOnline[_ngcontent-%COMP%]   ion-select.input-erro[_ngcontent-%COMP%]::part(icon){color:#f44336;opacity:1}.buttons-container[_ngcontent-%COMP%]{display:flex;margin:20px 0;justify-content:center;align-items:center;gap:10px}.buttons-container[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{color:#fff}.custom-loading[_ngcontent-%COMP%]   .loading-wrapper[_ngcontent-%COMP%]{background:#fff;border-radius:15px;box-shadow:0 0 15px #0000004d;display:flex;flex-direction:column;align-items:center}.custom-loading[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{margin-bottom:15px}.custom-loading[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:#444;text-align:center}"]}),l})()}];let w=(()=>{var i;class l{}return(i=l).\u0275fac=function(n){return new(n||i)},i.\u0275mod=o.$C({type:i}),i.\u0275inj=o.G2t({imports:[P.iI.forChild(E),P.iI]}),l})(),I=(()=>{var i;class l{}return(i=l).\u0275fac=function(n){return new(n||i)},i.\u0275mod=o.$C({type:i}),i.\u0275inj=o.G2t({imports:[x.MD,v.YN,u.bv,w]}),l})()}}]);